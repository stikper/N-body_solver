# üåå N-Body Solver

–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ N-—Ç–µ–ª —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —á–∏—Å–ª–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–∏–º—É–ª—è—Ç–æ—Ä –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è N —Ç–µ–ª –≤ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Ç–æ–¥–æ–≤ —á–∏—Å–ª–µ–Ω–Ω–æ–≥–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤.

## ‚ú® –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è:**
  - Explicit Euler (—è–≤–Ω—ã–π –º–µ—Ç–æ–¥ –≠–π–ª–µ—Ä–∞)
  - Runge-Kutta 4-–≥–æ –ø–æ—Ä—è–¥–∫–∞ (RK4)
  - Leap-Frog (—Å–∏–º–ø–ª–µ–∫—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥)

- **–í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏—Ö –≤–µ–ª–∏—á–∏–Ω:**
  - –ì—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏–ª—ã (–ø—Ä—è–º–æ–π –º–µ—Ç–æ–¥ O(N¬≤))
  - –ö–∏–Ω–µ—Ç–∏—á–µ—Å–∫–∞—è —ç–Ω–µ—Ä–≥–∏—è
  - –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è
  - –ü–æ–ª–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è —Å–∏—Å—Ç–µ–º—ã

- **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:**
  - 2D –∞–Ω–∏–º–∞—Ü–∏—è –æ—Ä–±–∏—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
  - –¢—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ —á–∞—Å—Ç–∏—Ü —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ —Å–ª–µ–¥–∞–º–∏
  - –ì—Ä–∞—Ñ–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏
  - –¢–µ–º–Ω–∞—è –∏ —Å–≤–µ—Ç–ª–∞—è —Ç–µ–º—ã –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –û—Ä–±–∏—Ç–∞ –ó–µ–º–ª–∏ –≤–æ–∫—Ä—É–≥ –°–æ–ª–Ω—Ü–∞

```python
from src import (
    ParticleData, Simulation, SimulationParameters,
    DirectForceCalculator, LFIntegrator, Animator2D
)

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
initial_data = ParticleData(
    masses=np.array([[1.989e30], [5.972e24]]),  # –°–æ–ª–Ω—Ü–µ, –ó–µ–º–ª—è
    positions=np.array([[0.0, 0.0, 0.0], [1.496e11, 0.0, 0.0]]),
    velocities=np.array([[0.0, 0.0, 0.0], [0.0, 29780.0, 0.0]])
)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏
parameters = SimulationParameters(
    force_calculator=DirectForceCalculator(),
    integrator=LFIntegrator(),
    dt=3600.0  # 1 —á–∞—Å
)

simulation = Simulation(initial_data, parameters)

# –ó–∞–ø—É—Å–∫ —Å–∏–º—É–ª—è—Ü–∏–∏
for i in range(8766):  # ~1 –≥–æ–¥
    simulation.step()
```

### –°–æ–ª–Ω–µ—á–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å–∏–º—É–ª—è—Ü–∏–∏ –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å 9 —Ç–µ–ª–∞–º–∏ (–°–æ–ª–Ω—Ü–µ + 8 –ø–ª–∞–Ω–µ—Ç) –¥–æ—Å—Ç—É–ø–µ–Ω –≤ `examples/solar_system.py`.

### –¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —ç–Ω–µ—Ä–≥–∏–∏

–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–æ–≤ –≤ `examples/energy_conservation_test.py`.

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
N-body_solver/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ core/              # –ë–∞–∑–æ–≤—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ physics/           # –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–∏–ª –∏ —ç–Ω–µ—Ä–≥–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ integrators/       # –ß–∏—Å–ª–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ simulation/        # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å–∏–º—É–ª—è—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ visualization/     # –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ examples/              # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ README.md
```

## üé® –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### –ê–Ω–∏–º–∞—Ü–∏—è 2D

```python
animator = Animator2D(
    positions_history=positions_history,
    masses=masses,
    dt=dt,
    particle_names=['Sun', 'Earth'],
    particle_colors=['yellow', 'dodgerblue'],
    title='Earth Orbit Around Sun',
    show_trails=True,
    dark_theme=True
)

animator.visualize(interval=1, repeat=True)
# animator.save('animation.mp4', fps=60, dpi=150)
```

### –ì—Ä–∞—Ñ–∏–∫ —ç–Ω–µ—Ä–≥–∏–∏

```python
energy_plotter = EnergyPlotter(
    times=times,
    kinetic_energies=kinetic_energies,
    potential_energies=potential_energies,
    total_energies=total_energies,
    title='Energy Conservation',
    dark_theme=True
)

energy_plotter.visualize(show_relative_error=True)
# energy_plotter.save('energy.png', dpi=300)
```

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã

- `G = 6.6743e-11` ‚Äî –≥—Ä–∞–≤–∏—Ç–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–æ—Å—Ç–æ—è–Ω–Ω–∞—è (–º¬≥/(–∫–≥¬∑—Å¬≤))
- `AU = 149597870700` ‚Äî –∞—Å—Ç—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∞—è –µ–¥–∏–Ω–∏—Ü–∞ (–º)

### –ú–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∏—è

| –ú–µ—Ç–æ–¥ | –¢–æ—á–Ω–æ—Å—Ç—å | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —ç–Ω–µ—Ä–≥–∏–∏ | –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ |
|-------|----------|-------------------|------------|
| Euler | O(dt) | –ü–ª–æ—Ö–æ–µ | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| RK4 | O(dt‚Å¥) | –•–æ—Ä–æ—à–µ–µ | –ö–æ—Ä–æ—Ç–∫–∏–µ —Å–∏–º—É–ª—è—Ü–∏–∏ |
| Leap-Frog | O(dt¬≤) | –û—Ç–ª–∏—á–Ω–æ–µ | –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –æ—Ä–±–∏—Ç—ã |

### –§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö

```python
ParticleData(
    masses: np.ndarray,      # shape: (n, 1)
    positions: np.ndarray,   # shape: (n, 3)
    velocities: np.ndarray,  # shape: (n, 3)
    forces: np.ndarray       # shape: (n, 3), optional
)
```

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

–ü—Ä—è–º–æ–π –º–µ—Ç–æ–¥ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å–∏–ª –∏–º–µ–µ—Ç —Å–ª–æ–∂–Ω–æ—Å—Ç—å **O(N¬≤)**, –≥–¥–µ N ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å—Ç–∏—Ü. –î–ª—è –±–æ–ª—å—à–∏—Ö —Å–∏—Å—Ç–µ–º (N > 1000) —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã Barnes-Hut –∏–ª–∏ FMM (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏).

## üéØ –ü—Ä–∏–º–µ—Ä—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ

1. **`earth_sun_orbit.py`** ‚Äî –ø—Ä–æ—Å—Ç–µ–π—à–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–∑ –¥–≤—É—Ö —Ç–µ–ª
2. **`solar_system.py`** ‚Äî –ø–æ–ª–Ω–∞—è —Å–∏–º—É–ª—è—Ü–∏—è –°–æ–ª–Ω–µ—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞ 10 –ª–µ—Ç
3. **`energy_conservation_test.py`** ‚Äî —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–æ—á–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ç–æ—Ä–æ–≤

## üõ†Ô∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `numpy` ‚Äî —á–∏—Å–ª–µ–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
- `matplotlib` ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∞–Ω–∏–º–∞—Ü–∏—è

## üìù –õ–∏—Ü–µ–Ω–∑–∏—è

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö.
